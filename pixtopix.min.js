(function(){(function(){if(!this.localStorage)if(this.globalStorage)try{this.localStorage=this.globalStorage}catch(e){}else{var t=document.createElement("div");t.style.display="none";document.getElementsByTagName("head")[0].appendChild(t);if(t.addBehavior){t.addBehavior("#default#userdata");var n=this.localStorage={length:0,setItem:function(e,n){t.load("localStorage");e=r(e);t.getAttribute(e)||this.length++;t.setAttribute(e,n);t.save("localStorage")},getItem:function(e){t.load("localStorage");e=r(e);return t.getAttribute(e)},removeItem:function(e){t.load("localStorage");e=r(e);t.removeAttribute(e);t.save("localStorage");this.length--;if(0>this.length)this.length=0},clear:function(){t.load("localStorage");for(var e=0;attr=t.XMLDocument.documentElement.attributes[e++];)t.removeAttribute(attr.name);t.save("localStorage");this.length=0},key:function(e){t.load("localStorage");return t.XMLDocument.documentElement.attributes[e]}},r=function(e){return e.replace(/[^-._0-9A-Za-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u37f-\u1fff\u200c-\u200d\u203f\u2040\u2070-\u218f]/g,"-")};t.load("localStorage");n.length=t.XMLDocument.documentElement.attributes.length}}})();window.Modernizr=function(e,t,n){function r(e){p.cssText=e}function i(e,t){return r(prefixes.join(e+";")+(t||""))}function s(e,t){return typeof e===t}function o(e,t){return!!~(""+e).indexOf(t)}function u(e,t,r){for(var i in e){var o=t[e[i]];if(o!==n)return r===!1?e[i]:s(o,"function")?o.bind(r||t):o}return!1}var a="2.7.1",f={},l=t.documentElement,c="modernizr",h=t.createElement(c),p=h.style,d,v={}.toString,m={},g={},y={},b=[],w=b.slice,E,S=function(){function e(e,i){i=i||t.createElement(r[e]||"div"),e="on"+e;var o=e in i;return o||(i.setAttribute||(i=t.createElement("div")),i.setAttribute&&i.removeAttribute&&(i.setAttribute(e,""),o=s(i[e],"function"),s(i[e],"undefined")||(i[e]=n),i.removeAttribute(e))),i=null,o}var r={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return e}(),x={}.hasOwnProperty,T;!s(x,"undefined")&&!s(x.call,"undefined")?T=function(e,t){return x.call(e,t)}:T=function(e,t){return t in e&&s(e.constructor.prototype[t],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if(typeof t!="function")throw new TypeError;var n=w.call(arguments,1),r=function(){if(this instanceof r){var i=function(){};i.prototype=t.prototype;var s=new i,o=t.apply(s,n.concat(w.call(arguments)));return Object(o)===o?o:s}return t.apply(e,n.concat(w.call(arguments)))};return r}),m.draganddrop=function(){var e=t.createElement("div");return"draggable"in e||"ondragstart"in e&&"ondrop"in e};for(var N in m)T(m,N)&&(E=N.toLowerCase(),f[E]=m[N](),b.push((f[E]?"":"no-")+E));return f.addTest=function(e,t){if(typeof e=="object")for(var r in e)T(e,r)&&f.addTest(r,e[r]);else{e=e.toLowerCase();if(f[e]!==n)return f;t=typeof t=="function"?t():t,typeof enableClasses!="undefined"&&enableClasses&&(l.className+=" "+(t?"":"no-")+e),f[e]=t}return f},r(""),h=d=null,f._version=a,f.hasEvent=S,f}(this,this.document),Modernizr.addTest("filereader",function(){return!!(window.File&&window.FileList&&window.FileReader)});"use strict";var e,t,n,r,i,s,o,u,a,f,l,c,h,p;(function(){var e,t;if(!window.console){window.console={}}t=["log","info","warn","error","debug","trace","dir","group","groupCollapsed","groupEnd","time","timeEnd","profile","profileEnd","dirxml","assert","count","markTimeline","timeStamp","clear"];e=0;while(e<t.length){if(!window.console[t[e]]){window.console[t[e]]=function(){}}e++}})();t={counter:0,first:false,power:false,pin:false,ie:0,key:function(){return e("keydown",document,function(e){e=e||window.event;if(e.altKey&&e.keyCode===82){t.reset()}})},reset:function(){r.animPress(r.eReset);i.clearAll();location.reload();return false},init:function(){if(this.counter!==0){return}this.counter++;this.addStyle();this.key();r.generate();r.init();u.layout.generate();if(Modernizr.filereader&&Modernizr.draganddrop){a.layout.generate("drop");a.init("drop")}else{a.layout.generate("text");a.init("text")}if(u.onLocalStorage()){this.first=false;r.show();u.init();l.init();f.init();p.init();if(t.power){return a.layout.hideTextBox()}else{return a.layout.hide()}}else{return this.first=true}},addStyle:function(){var e,t;e=document.getElementsByTagName("head")[0];t=document.createElement("link");t.rel="stylesheet";t.type="text/css";t.href="http://cdn.jsdelivr.net/pixtopix/latest/pixtopix.css";t.media="all";return e.appendChild(t)}};u={layout:{generate:function(){var e,t;t=document.createElement("img");t.id="pix2pix";t.style.position="absolute";t.style.left="50%";t.style.display="none";t.style.zIndex=1e4;t.draggable=true;t.src="";e=document.body.firstChild;document.body.insertBefore(t,e);return u.elem=document.getElementById("pix2pix")},show:function(){var e;console.log("show");t.power=true;try{r.press(r.ePower);u.elem.style.display="block"}catch(n){e=n}return this.save()},hide:function(){var e;t.power=false;try{r.unPress(r.ePower);u.elem.style.display="none"}catch(n){e=n}return this.save()},toggle:function(){if(u.setCounter===void 0){u.set()}if(t.power===true){return this.hide()}else{return this.show()}},get:function(){return t.power=i.get("power")==="true"||i.get("power")===true?true:false},save:function(){return i.save("power",t.power)},key:function(){e("keydown",document,function(e){e=e||window.event;if(e.keyCode===192&&!e.shiftKey||!e.shiftKey&&e.keyCode===220&&t.ie){u.layout.toggle();return false}});return e("keydown",document,function(e){e=e||window.event;if(e.keyCode===73&&!t.pin){u.getNewImage();return false}})}},init:function(){this.layout.get();this.layout.key();this.get();if(t.power){return this.set()}},getNewImage:function(){r.animPress(r.eNewImage);t.power=false;a.power=true;this.layout.hide();a.layout.show();return r.hide()},onLocalStorage:function(){this.get();if(this.path===null||this.path==="undefined"||this.path===""){return false}else{return true}},set:function(){if(this.setCounter===void 0){this.setCounter=1}else{this.setCounter++}this.elem.onload=function(){u.layout.show();c.init();a.layout.hide();return s("pix2pix",function(){c.get(true);return c.save()})};this.elem.src=this.path;return this.save()},get:function(){return this.path=i.get("path")},save:function(){return i.save("path",this.path)},change:function(e){this.path=e;return this.set()}};a={dragClass:"pp-drag",loadingClass:"b-pp-loading",status:false,layout:{generate:function(e){var t,n,r,i;i="";e=e||"text";if(e==="text"){i='<p>Enter url to image file</p><form action="#" id="b-pp-formFile"><input type="text" id="b-pp-drop__text" placeholder="../img/index.jpg"> <span class="b-pp__btn" id="b-pp-drop__submit">Send</span></form>'}else if(e==="drop"){i='<p>Drag\'n\'drop image file</p><p>OR</p><span class="b-pp-drop__file-box b-pp__btn">BROWSE<input type="file" id="b-pp-drop__file"></span>'}r='<div class="b-pp-drop__border"><div id="b-pp-drop__text-box" class="b-pp-drop__text-box">'+i+"</div></div>";r=r.replace(/\t/g,"");t=document.createElement("div");t.id="b-pp-drop";t.className="b-pp-drop b-pp-tp-black";t.innerHTML=r;n=document.body.firstChild;document.body.insertBefore(t,n);a.eShadow=document.getElementById("b-pp-drop");a.eTextBox=document.getElementById("b-pp-drop__text-box");a.eFileUlpoad=document.getElementById("b-pp-drop__file");a.eForm=document.getElementById("b-pp-formFile");a.eSubmit=document.getElementById("b-pp-drop__submit");a.eTextSubmit=document.getElementById("b-pp-drop__text");if(e==="text"){return a.eTextSubmit.focus()}},show:function(){var e;a.status=true;t.power=false;try{u.elem.style.display="none";a.eShadow.style.display="";a.eTextSubmit.focus()}catch(n){e=n}return this.showTextBox()},hide:function(){var e;a.status=false;t.power=true;try{u.elem.style.display="";return a.eShadow.style.display="none"}catch(n){e=n}},showTextBox:function(){n.remove(a.eShadow,a.loadingClass);return a.eTextBox.style.display=""},hideTextBox:function(){n.add(a.eShadow,a.loadingClass);return a.eTextBox.style.display="none"}},init:function(e){if(e==="text"){if(!this.status){this.status=true;return this.inputTextLoad()}}else if(e==="drop"){if(!this.status){this.status=true;this.inputFileLoad();return this.dropLoad()}}},inputTextLoad:function(){this.eSubmit.onclick=function(){if(a.eTextSubmit.value!==""){return a.endFileLoad(a.eTextSubmit.value)}};return this.eForm.onsubmit=function(){if(a.eTextSubmit.value!==""){return a.endFileLoad(a.eTextSubmit.value)}}},inputFileLoad:function(){return this.eFileUlpoad.addEventListener("change",function(e){return a.fileUpload(e,function(e){return a.endFileLoad(e)})},false)},dropLoad:function(){var e,t;e=document.documentElement;t=function(e){var t;t=document.getElementsByTagName("html")[0];n.add(t,a.dragClass);e.preventDefault()};e.addEventListener("dragover",t,false);e.addEventListener("drop",function(e){var t;console.log("drop");t=document.getElementsByTagName("html")[0];n.remove(t,a.dragClass);a.fileUpload(e,function(e){return a.endFileLoad(e)})},false);return e.addEventListener("dragleave",function(){var e;console.log("leave");e=document.getElementsByTagName("html")[0];n.remove(e,a.dragClass)},false)},fileUpload:function(e,t){var r,i,s,o,u;r="";s=null;if(e.dataTransfer){s=e.dataTransfer.files[0]||null}else{if(this.eFileUlpoad.files){s=this.eFileUlpoad.files[0]||null}}if(typeof FileReader!=="undefined"&&s.type.indexOf("image")!==-1){o=new FileReader;u=document.getElementById("b-pp-drop__text-box");i=document.getElementById("b-pp-drop");u.style.display="none";n.add(i,"b-pp-loading");o.onload=function(e){r=e.target.result;return t&&t(r)};o.readAsDataURL(s)}else{this.eFileUlpoad.value="";alert("Upload file is not image.")}e.preventDefault()},endFileLoad:function(e){a.layout.hideTextBox();r.show();if(e!=null&&e!==""){u.change(e);a.layout.hide();u.layout.show()}else{return false}if(t.first){u.layout.key();l.init();f.init();return p.init()}},key:{bind:function(){},unbind:function(){}}};f={opacity:.7,init:function(){this.get();this.set();return this.key()},set:function(){u.elem.style.opacity=this.opacity;u.elem.style.filter="alpha(opacity="+this.opacity*100+")";return this.save()},get:function(){if(i.get("opacity")!==null){return this.opacity=i.get("opacity")*1}},save:function(){clearTimeout(this.interVl);return this.interVl=setTimeout(function(){return i.save("opacity",f.opacity)},200)},change:function(e){var t;t=this.opacity*1;if(e==="+"){if(t!==1){this.opacity=(this.opacity*1+.1).toFixed(1);r.animPress(r.ePlus)}}else{if(t!==0){this.opacity=(this.opacity-.1).toFixed(1);r.animPress(r.eMinus)}}return this.set()},key:function(){return e("keydown",document,function(e){e=e||window.event;if(!t.pin){if(e.keyCode===107||e.shiftKey&&e.keyCode===187){f.change("+");return false}if(e.keyCode===109||e.shiftKey&&e.keyCode===189){f.change("-");return false}}})}};p={sPower:false,init:function(){this.key();this.get();if(this.sPower===true){return this.set()}else{return this.remove()}},set:function(){var e,t,n,i;i="* {-webkit-box-shadow: 0px 0px 4px 0 #"+this.sColor+" ;box-shadow: 0px 0px 4px 0 #"+this.sColor+";} #b-pp, #b-pp *, #b-pp-drop, #b-pp-drop * {box-shadow: none}";if(document.getElementById("pix2pix__shadow")===null){n=document.createElement("style");n.id="pix2pix__shadow";n.textContent=i;t=document.body.firstChild;document.body.insertBefore(n,t)}else{try{document.getElementById("pix2pix__shadow").innerHTML=i}catch(s){e=s}}r.press(r.eShadow);return this.save()},remove:function(){var e;if(document.getElementById("pix2pix__shadow")!==null){try{document.getElementById("pix2pix__shadow").innerHTML=""}catch(t){e=t}}r.unPress(r.eShadow);return this.save()},get:function(){this.sPower=i.get("shadowPower")===true||i.get("shadowPower")==="true"?true:false;return this.sColor=i.get("shadowColor")===null?"165563":i.get("shadowColor")},save:function(){i.save("shadowPower",this.sPower);return i.save("shadowColor",this.sColor)},changeColor:function(){this.sColor=this.randomHexColor();return this.set()},randomHexColor:function(){return""+Math.floor(Math.random()*16777215).toString(16)},toggle:function(){if(this.sPower===true){this.sPower=false;this.remove()}else{this.sPower=true;this.set()}return this.save()},key:function(){return e("keydown",document,function(e){e=e||window.event;if(!t.pin){if(e.keyCode===106&&e.ctrlKey||e.shiftKey&&e.ctrlKey&&e.keyCode===56){p.changeColor();return false}if(e.keyCode===106||e.shiftKey&&e.keyCode===56){p.toggle();return false}}})}};l={state:false,init:function(){this.key();this.get();this.save();this.change();return this.change()},get:function(){this.state=i.get("pin")===true||i.get("pin")==="true"?true:false;return t.pin=this.state},save:function(){return i.save("pin",this.state)},change:function(){if(this.state===true){this.state=false;t.pin=this.state;r.unPress(r.ePin)}else{this.state=true;t.pin=this.state;r.press(r.ePin)}this.toggleDisable();return this.save()},toggleDisable:function(){var e;e="ppDisable";if(this.state===true){n.add(r.eShadow,e);n.add(r.eNewImage,e);n.add(r.ePlus,e);return n.add(r.eMinus,e)}else{n.remove(r.eShadow,e);n.remove(r.eNewImage,e);n.remove(r.ePlus,e);return n.remove(r.eMinus,e)}},key:function(){return e("keydown",document,function(e){e=e||window.event;if(e.shiftKey&&e.keyCode===192||e.shiftKey&&e.keyCode===220&&t.ie){l.change();return false}return false})}};c={left:0,top:0,init:function(){var e;this.key();if(t.first){e=u.elem.width/2*-1;return this.change(e,this.top)}else{this.get();return this.set()}},set:function(){u.elem.style.marginLeft=this.left+"px";u.elem.style.top=this.top+"px";return this.save()},get:function(e){if(e){this.top=parseInt(u.elem.style.top,10);return this.left=parseInt(u.elem.style.marginLeft,10)}else{this.top=i.get("top")*1||0;return this.left=i.get("left")*1||0}},save:function(){clearTimeout(this.interV);return this.interV=setTimeout(function(){i.save("top",c.top);return i.save("left",c.left)},400)},change:function(e,t){this.left=e*1;this.top=t*1;return this.set()},key:function(){return e("keydown",document,function(e){e=e||window.event;if(e.keyCode===38&&e.shiftKey){c.change(c.left,c.top-10);return false}if(e.keyCode===38){c.change(c.left,c.top-1);return false}if(e.keyCode===40&&e.shiftKey){c.change(c.left,c.top+10);return false}if(e.keyCode===40){c.change(c.left,c.top+1);return false}if(e.keyCode===37&&e.shiftKey){c.change(c.left-10,c.top);return false}if(e.keyCode===37){c.change(c.left-1,c.top);return false}if(e.keyCode===39&&e.shiftKey){c.change(c.left+10,c.top);return false}if(e.keyCode===39){c.change(c.left+1,c.top);return false}})}};r={started:false,power:false,init:function(){var e;e=this;this.ePower=document.getElementById("ppIdPower");this.ePin=document.getElementById("ppIdPin");this.eShadow=document.getElementById("ppIdShadow");this.eReset=document.getElementById("ppIdReset");this.eNewImage=document.getElementById("ppIdImage");this.ePlus=document.getElementById("ppIdOpp");this.eMinus=document.getElementById("ppIdOpm");this.ePower.onclick=function(){return u.layout.toggle()};this.ePin.onclick=function(){return l.change()};this.eShadow.onclick=function(){if(!t.pin){return p.toggle()}};this.eNewImage.onclick=function(){if(!t.pin){return u.getNewImage()}};this.eReset.onclick=function(){return t.reset()};this.ePlus.onclick=function(){if(!t.pin){return f.change("+")}};this.eMinus.onclick=function(){if(!t.pin){return f.change("-")}};return r.init=function(){}},show:function(){return this.el.style.display="block"},hide:function(){return this.el.style.display="none"},press:function(e){return n.add(e,"active")},unPress:function(e){return n.remove(e,"active")},animPress:function(e){n.add(e,"active");return setTimeout(function(){return n.remove(e,"active")},100)},generate:function(){var e,t,n;e=document.createElement("div");e.id="b-pp";e.className="b-pp-tp-black";e.style.display="none";n='<div class="b-pp__line"> <div class="b-pp__cell"><span id="ppIdPower" class="b-pp__btn b-pp__icon checker power" title="Power on / off - [ ` ]"></span></div> <div class="b-pp__cell"><span id="ppIdPin" class="b-pp__btn b-pp__icon checker pin" title="Pin / unpin - [ Shift + ` ]"></span></div> <div class="b-pp__cell"><span id="ppIdShadow" class="b-pp__btn b-pp__icon checker shadow" title="Highlight elements yes / no - [ * ]"></span></div> <div class="b-pp__cell"><span id="ppIdImage" class="b-pp__btn b-pp__icon edit" title="Change current image - [ Ctrl + i ]"></span></div> <div class="b-pp__cell"><span id="ppIdOpp" class="b-pp__btn b-pp__icon plus" title="Increase opacity on 10% - [ + ]"></span></div> <div class="b-pp__cell"><span id="ppIdOpm" class="b-pp__btn b-pp__icon minus" title="Decrease opacity on 10% - [ - ]"></span></div> <div class="b-pp__cell"><span id="ppIdReset" class="b-pp__btn b-pp__icon delete" title="Reset settings - [ Alt + r ]"></span></div> <div class="b-pp__cell"><span id="ppIdInfo" class="b-pp__btn b-pp__icon info" title="More info about pixToPix - [ F1 ]"></span></div> </div>';e.innerHTML=n;t=document.body.firstChild;document.body.insertBefore(e,t);this.started=true;return this.el=document.getElementById("b-pp")}};e=function(e,t,n){if(t.addEventListener){t.addEventListener(e,n,false)}else if(t.attachEvent){t.attachEvent("on"+e,n)}else{t["on"+e]=n}};h=function(e,t,n){if(t.addEventListener){t.removeEventListener(e,n,false)}else if(t.detachEvent){t.detachEvent("on"+e,n)}else{t["on"+e]=null}};i={save:function(e,t){var n;e="pix2pix_"+e;try{return localStorage.setItem(e,t)}catch(r){n=r;return document.cookie=e+"="+window.escape(t)}},get:function(e){var t,n;e="pix2pix_"+e;try{return localStorage.getItem(e)}catch(r){t=r;n=document.cookie.match("(^|;) ?"+e+"=([^;]*)(;|$)");if(n){return window.unescape(n[2])}else{return null}}},clearAll:function(){var e,t,n,r,i,s,o;try{localStorage.clear()}catch(u){n=u}t=document.cookie.split(";");i=0;o=[];while(i<t.length){e=t[i];r=e.indexOf("=");s=r>-1?e.substr(0,r):e;document.cookie=s+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT";o.push(i++)}return o}};n={add:function(e,t){try{if(e.className.indexOf(t)===-1){return e.className+=" "+t}}catch(n){e=n;return console.log("cCls.add",e)}},replace:function(e,t,n){try{return e.className=e.className.replace(new RegExp(t,"g"),n)}catch(r){e=r}},remove:function(e,t){try{return this.replace(e,t,"")}catch(n){e=n}},has:function(e,t){try{if(e.className.indexOf(t)!==-1){return true}else{return false}}catch(n){e=n}}};s=function(e,n){var r;r=function(e){var t,n;if(e.pageX==null&&e.clientX!=null){n=document.documentElement;t=document.body;e.pageX=e.clientX+(n.scrollLeft||t&&t.scrollLeft||0);e.pageX-=n.clientLeft||0;e.pageY=e.clientY+(n.scrollTop||t&&t.scrollTop||0);e.pageY-=n.clientTop||0}};document.getElementById(e).onmousedown=function(e){var i,s,o,u,a,f,l;if(t.pin){return}s=parseInt(this.style.top,10);i=parseInt(this.style.marginLeft,10);e=e||event;r(e);f=e.pageX;l=e.pageY;this.style.position="absolute";a=this;o=document.onmousemove;document.onmousemove=function(e){e=e||event;r(e);a.style.marginLeft=i-(f-e.pageX)+"px";a.style.top=s-(l-e.pageY)+"px";a.style.cursor="move"};u=document.onmouseup;document.onmouseup=function(){a.style.cursor="default";n&&n();document.onmousemove=o;document.onmouseup=u}};return document.getElementById(e).ondragstart=function(){return false}};try{t.init()}catch(d){o=d}window.onload=function(){return t.init()}}).call(this)